select * from table1
left join table 2
on a.b=b.a
where a=b
group by abc
having dsf;
